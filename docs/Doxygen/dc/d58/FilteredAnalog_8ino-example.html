<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: FilteredAnalog.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script type="text/javascript" async="async" src="/MathJax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Control Surface
   &#160;<span id="projectnumber">1.1.0</span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">FilteredAnalog.ino</div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md0"></a>
FilteredAnalog</h1>
<p>This examples shows how to filter an analog input, so you can get the position of a knob or fader without noise.</p>
<dl class="section user"><dt>Boards:</dt><dd>AVR, AVR USB, Due, Nano 33, Teensy 3.x, ESP32</dd></dl>
<h2><a class="anchor" id="autotoc_md1"></a>
Connections</h2>
<ul>
<li>A0: wiper of a potentiometer</li>
</ul>
<p>Connect the left terminal of the potentiometer to ground, and the right one to V<sub>CC</sub>.</p>
<h2><a class="anchor" id="autotoc_md2"></a>
Behavior</h2>
<ul>
<li>Upload the sketch to the Arduino, and open the Serial Monitor (<code>CTRL+Shift+M</code>)</li>
<li>When you turn the potentiometer, you should see the position of the potentiometer being printed as a number between 0 and 1023.</li>
<li>The analog input is filtered, so there shouldn't be any noise on the position. If there is, check your wiring, and make sure that the resistance of the potentiometer isn't too high (10 kΩ is ideal).</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Mapping</h2>
<p>None.</p>
<p>Written by PieterP, 2019-10-10 <br  />
 <a href="https://github.com/tttapa/Control-Surface">https://github.com/tttapa/Control-Surface</a></p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * This examples shows how to filter an analog input, so you can get the </span></div>
<div class="line"><span class="comment"> * position of a knob or fader without noise.</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * @boards  AVR, AVR USB, Due, Nano 33, Teensy 3.x, ESP32</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Connections</span></div>
<div class="line"><span class="comment"> * -----------</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * - A0: wiper of a potentiometer</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Connect the left terminal of the potentiometer to ground, and the right one</span></div>
<div class="line"><span class="comment"> * to V&lt;sub&gt;CC&lt;/sub&gt;.</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Behavior</span></div>
<div class="line"><span class="comment"> * --------</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * - Upload the sketch to the Arduino, and open the Serial Monitor </span></div>
<div class="line"><span class="comment"> *   (`CTRL+Shift+M`)</span></div>
<div class="line"><span class="comment"> * - When you turn the potentiometer, you should see the position of the </span></div>
<div class="line"><span class="comment"> *   potentiometer being printed as a number between 0 and 1023.</span></div>
<div class="line"><span class="comment"> * - The analog input is filtered, so there shouldn&#39;t be any noise on the </span></div>
<div class="line"><span class="comment"> *   position. If there is, check your wiring, and make sure that the resistance</span></div>
<div class="line"><span class="comment"> *   of the potentiometer isn&#39;t too high (10 kΩ is ideal). </span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Mapping</span></div>
<div class="line"><span class="comment"> * -------</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * None.</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * Written by PieterP, 2019-10-10  </span></div>
<div class="line"><span class="comment"> * https://github.com/tttapa/Control-Surface</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Include the library</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a filtered analog object on pin A0:</span></div>
<div class="line">FilteredAnalog&lt;10,      <span class="comment">// Output precision in bits</span></div>
<div class="line">               2,       <span class="comment">// The amount of filtering</span></div>
<div class="line">               uint16_t <span class="comment">// The integer type for the calculations</span></div>
<div class="line">               &gt;</div>
<div class="line">  analog = A0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// If you want more filtering, you can increase the filter shift factor.</span></div>
<div class="line"><span class="comment">// The number of bits required for the intermediate calculations increases if</span></div>
<div class="line"><span class="comment">// you do so, so you have to use a larger type as well.</span></div>
<div class="line">FilteredAnalog&lt;10,      <span class="comment">// Output precision in bits</span></div>
<div class="line">               6,       <span class="comment">// The amount of filtering</span></div>
<div class="line">               uint32_t <span class="comment">// The integer type for the calculations</span></div>
<div class="line">               &gt;</div>
<div class="line">  moreFiltering = A0;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// If you don&#39;t care about the specific settings, and just want a</span></div>
<div class="line"><span class="comment">// default that works, you can use the following:</span></div>
<div class="line">FilteredAnalog&lt;&gt; simpleAnalog = A0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  Serial.begin(115200);</div>
<div class="line">  <span class="keywordflow">while</span> (!Serial)</div>
<div class="line">    ;</div>
<div class="line">  <span class="comment">// Select the correct ADC resolution</span></div>
<div class="line">  FilteredAnalog&lt;&gt;::setupADC();</div>
<div class="line">  <span class="comment">// If you want, you can add mapping functions to invert the input, for example</span></div>
<div class="line">  analog.invert();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <span class="comment">// Read the analog input every millisecond, and print if the value has changed</span></div>
<div class="line">  <span class="keyword">static</span> Timer&lt;millis&gt; timer = 1; <span class="comment">// ms</span></div>
<div class="line">  <span class="keywordflow">if</span> (timer &amp;&amp; analog.update())</div>
<div class="line">    Serial.println(analog.getValue());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Explanation:</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// analog.update() reads the analog input, applies the filters,</span></div>
<div class="line">  <span class="comment">// saves the value, and returns true if the value has changed.</span></div>
<div class="line">  <span class="comment">// You can then retreive the new value using analog.getValue().</span></div>
<div class="line">  <span class="comment">//</span></div>
<div class="line">  <span class="comment">// Timer is just a &quot;Blink Without Delay&quot; wrapper, it returns true</span></div>
<div class="line">  <span class="comment">// every time the specified amount of time has passed.</span></div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="aControl__Surface_8h_html"><div class="ttname"><a href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a></div><div class="ttdoc">The main header file that includes all Control-Surface header files.</div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
