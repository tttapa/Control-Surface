<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Arduino Helpers: 1.FilteredAnalog.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script>
<script type="text/javascript" async="async" src="/MathJax/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Arduino Helpers
   &#160;<span id="projectnumber">master</span>
   </div>
   <div id="projectbrief">Utility library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">1.FilteredAnalog.ino</div>  </div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md9"></a>
1.FilteredAnalog</h1>
<p>This examples shows how to filter an analog input, so you can get the position of a knob or fader without noise.</p>
<dl class="section user"><dt>Boards:</dt><dd>AVR, AVR USB, Nano Every, Nano 33 IoT, Nano 33 BLE, Due, Teensy 3.x, ESP8266, ESP32</dd></dl>
<h2><a class="anchor" id="autotoc_md10"></a>
Connections</h2>
<ul>
<li>A0: wiper of a potentiometer</li>
</ul>
<p>Connect the left terminal of the potentiometer to ground, and the right one to V<sub>CC</sub>.</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Behavior</h2>
<ul>
<li>Upload the sketch to the Arduino, and open the Serial Monitor (<code>CTRL+Shift+M</code>)</li>
<li>When you turn the potentiometer, you should see the position of the potentiometer being printed as a number between 0 and 1023.</li>
<li>The analog input is filtered, so there shouldn't be any noise on the position. If there is, check your wiring, and make sure that the resistance of the potentiometer isn't too high (10 kÎ© is ideal).</li>
</ul>
<p>The example <a class="el" href="../../d1/d08/1_8FilteredAnalog-Advanced_8ino-example.html">1.FilteredAnalog-Advanced.ino</a> has more information about the parameters you can pass to the <a class="el" href="../../da/da7/classFilteredAnalog.html" title="A class that reads and filters an analog input.">FilteredAnalog</a> class to tweak the filters, increase the resolution, etc.</p>
<p>Written by PieterP, 2019-10-10 <br  />
 <a href="https://github.com/tttapa/Arduino-Helpers">https://github.com/tttapa/Arduino-Helpers</a></p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">// Include the library</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../dc/de6/Arduino__Helpers_8h.html">Arduino_Helpers.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d8/df3/FilteredAnalog_8hpp.html">AH/Hardware/FilteredAnalog.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../d1/dd0/MillisMicrosTimer_8hpp.html">AH/Timing/MillisMicrosTimer.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create a filtered analog object on pin A0, with the default settings:</span></div>
<div class="line"><a name="_a0"></a><a class="code" href="../../da/da7/classFilteredAnalog.html">FilteredAnalog&lt;&gt;</a> analog = A0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  Serial.begin(115200);</div>
<div class="line">  <span class="keywordflow">while</span> (!Serial);</div>
<div class="line">  <span class="comment">// Select the correct ADC resolution</span></div>
<div class="line">  analog.<a name="a1"></a><a class="code" href="../../dc/d91/classGenericFilteredAnalog.html#a3cec68e11b712453289f34d1634f86b8">setupADC</a>();</div>
<div class="line">  <span class="comment">// Initialize the filter to whatever the value on the input is right now</span></div>
<div class="line">  <span class="comment">// (otherwise, the filter is initialized to zero and you get transients)</span></div>
<div class="line">  analog.<a name="a2"></a><a class="code" href="../../dc/d91/classGenericFilteredAnalog.html#a22ec6f8b6a600fac80d3366840e5c55f">resetToCurrentValue</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <span class="comment">// Read the analog input every millisecond, and print if the value has changed</span></div>
<div class="line">  <span class="keyword">static</span> <a name="_a3"></a><a class="code" href="../../dc/dea/classTimer.html">Timer&lt;millis&gt;</a> timer = 1; <span class="comment">// ms</span></div>
<div class="line">  <span class="keywordflow">if</span> (timer &amp;&amp; analog.<a name="a4"></a><a class="code" href="../../dc/d91/classGenericFilteredAnalog.html#aa2aac016e2bf7b5bd2b271786c2791aa">update</a>())</div>
<div class="line">    Serial.println(analog.<a name="a5"></a><a class="code" href="../../dc/d91/classGenericFilteredAnalog.html#a8a4d365b8958084f9cb9176fe638bfae">getValue</a>());</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Explanation:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// analog.update() reads the analog input, applies the filters,</span></div>
<div class="line"><span class="comment">// saves the value, and returns true if the value has changed.</span></div>
<div class="line"><span class="comment">// You can then retreive the new value using analog.getValue().</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Timer is just a &quot;Blink Without Delay&quot; wrapper, it returns true</span></div>
<div class="line"><span class="comment">// every time the specified amount of time has passed.</span></div>
<div class="ttc" id="aArduino__Helpers_8h_html"><div class="ttname"><a href="../../dc/de6/Arduino__Helpers_8h.html">Arduino_Helpers.h</a></div><div class="ttdoc">Dummy header file for Arduino builder.</div></div>
<div class="ttc" id="aFilteredAnalog_8hpp_html"><div class="ttname"><a href="../../d8/df3/FilteredAnalog_8hpp.html">FilteredAnalog.hpp</a></div></div>
<div class="ttc" id="aMillisMicrosTimer_8hpp_html"><div class="ttname"><a href="../../d1/dd0/MillisMicrosTimer_8hpp.html">MillisMicrosTimer.hpp</a></div></div>
<div class="ttc" id="aclassFilteredAnalog_html"><div class="ttname"><a href="../../da/da7/classFilteredAnalog.html">FilteredAnalog</a></div><div class="ttdoc">A class that reads and filters an analog input.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df3/FilteredAnalog_8hpp_source.html#l00263">FilteredAnalog.hpp:266</a></div></div>
<div class="ttc" id="aclassGenericFilteredAnalog_html_a22ec6f8b6a600fac80d3366840e5c55f"><div class="ttname"><a href="../../dc/d91/classGenericFilteredAnalog.html#a22ec6f8b6a600fac80d3366840e5c55f">GenericFilteredAnalog::resetToCurrentValue</a></div><div class="ttdeci">void resetToCurrentValue()</div><div class="ttdoc">Reset the filtered value to the value that's currently being measured at the analog input.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df3/FilteredAnalog_8hpp_source.html#l00077">FilteredAnalog.hpp:77</a></div></div>
<div class="ttc" id="aclassGenericFilteredAnalog_html_a3cec68e11b712453289f34d1634f86b8"><div class="ttname"><a href="../../dc/d91/classGenericFilteredAnalog.html#a3cec68e11b712453289f34d1634f86b8">GenericFilteredAnalog::setupADC</a></div><div class="ttdeci">static void setupADC()</div><div class="ttdoc">Select the configured ADC resolution.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df3/FilteredAnalog_8hpp_source.html#l00173">FilteredAnalog.hpp:173</a></div></div>
<div class="ttc" id="aclassGenericFilteredAnalog_html_a8a4d365b8958084f9cb9176fe638bfae"><div class="ttname"><a href="../../dc/d91/classGenericFilteredAnalog.html#a8a4d365b8958084f9cb9176fe638bfae">GenericFilteredAnalog::getValue</a></div><div class="ttdeci">AnalogType getValue() const</div><div class="ttdoc">Get the filtered value of the analog input (with the mapping function applied).</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df3/FilteredAnalog_8hpp_source.html#l00133">FilteredAnalog.hpp:133</a></div></div>
<div class="ttc" id="aclassGenericFilteredAnalog_html_aa2aac016e2bf7b5bd2b271786c2791aa"><div class="ttname"><a href="../../dc/d91/classGenericFilteredAnalog.html#aa2aac016e2bf7b5bd2b271786c2791aa">GenericFilteredAnalog::update</a></div><div class="ttdeci">bool update()</div><div class="ttdoc">Read the analog input value, apply the mapping function, and update the average.</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/df3/FilteredAnalog_8hpp_source.html#l00115">FilteredAnalog.hpp:115</a></div></div>
<div class="ttc" id="aclassTimer_html"><div class="ttname"><a href="../../dc/dea/classTimer.html">Timer</a></div><div class="ttdoc">A class for easily managing timed events.</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/dd0/MillisMicrosTimer_8hpp_source.html#l00028">MillisMicrosTimer.hpp:28</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
