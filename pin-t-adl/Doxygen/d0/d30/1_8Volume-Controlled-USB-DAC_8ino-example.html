<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: 1.Volume-Controlled-USB-DAC.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Roboto:wght@400&family=Roboto:wght@500&display=swap" rel="stylesheet">
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Control Surface<span id="projectnumber">&#160;<code><a href="/Control-Surface/">pin-t-adl</a></code></span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">1.Volume-Controlled-USB-DAC.ino</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md1volume-controlled-usb-dac"></a>
1.Volume-Controlled-USB-DAC</h1>
<p>This is an example of the <a class="el" href="../../d4/de3/classVolumeControl.html" title="A class for controlling the volume of AudioMixer4 objects using a potentiometer.">VolumeControl</a> class of the Control Surface library. It acts as a USB Audio DAC (Digital-to-Analog Converter).</p>
<dl class="section user"><dt>Boards: <b class="boards-info" title="Control Surface&apos;s automated continuous integration workflows regularly verify that this example compiles successfully for the following boards. The list is not exhaustive, and the example will most likely work on other boards as well (perhaps requiring slight modifications).">ðŸ›ˆ</b> </dt><dd>Teensy 3.x</dd></dl>
<h2><a class="anchor" id="connections-7"></a>
Connections</h2>
<p>This specific example uses an IÂ²S DAC, but you can use other interfaces of the Teensy Audio library as well. For testing, I'm using a PCM5102a.</p>
<ul>
<li>A0: wiper of a potentiometer to change the output volume</li>
<li>9: DAC BCK (IÂ²S)</li>
<li>11: DAC SCK (IÂ²S)</li>
<li>22: DAC DIN (IÂ²S)</li>
<li>23: DAC LRCK (IÂ²S)</li>
</ul>
<p>Connect the left terminal of the potentiometer to ground, and the right one to V<sub>CC</sub>.</p>
<p>Select a USB audio option from the Tools menu in the IDE.</p>
<h2><a class="anchor" id="behavior-9"></a>
Behavior</h2>
<p>Upload the sketch, and select the Control Surface as the audio output of your computer. Connect the output of the DAC to a pair of headphones or powered speakers, and play some music. <br  />
 You can now adjust the volume using the potentiometer.</p>
<h2><a class="anchor" id="mapping-9"></a>
Mapping</h2>
<p>None.</p>
<p>Written by PieterP, 2019-08-09 <br  />
 <a href="https://github.com/tttapa/Control-Surface">https://github.com/tttapa/Control-Surface</a></p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span> <span class="comment">// Include the Control Surface library</span></div>
<div class="line"> </div>
<div class="line">AudioInputUSB audioInputUSB; <span class="comment">// The audio input from the USB connection</span></div>
<div class="line">AudioMixer4 mixer_L;         <span class="comment">// Two mixers for volume control</span></div>
<div class="line">AudioMixer4 mixer_R;</div>
<div class="line">AudioOutputI2S audioOutputI2S; <span class="comment">// The output to the IÂ²S DAC</span></div>
<div class="line"> </div>
<div class="line">AudioConnection patchCord1(audioInputUSB, 0, mixer_L, 0);  <span class="comment">// Connect the input</span></div>
<div class="line">AudioConnection patchCord3(audioInputUSB, 1, mixer_R, 0);  <span class="comment">// to the mixer</span></div>
<div class="line">AudioConnection patchCord5(mixer_L, 0, audioOutputI2S, 1); <span class="comment">// Connect the mixer</span></div>
<div class="line">AudioConnection patchCord6(mixer_R, 0, audioOutputI2S, 0); <span class="comment">// to the output</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate a VolumeControl object with a potentiometer on pin A0 and a</span></div>
<div class="line"><span class="comment">// maximum gain of 1.0</span></div>
<div class="line"><a id="_a0" name="_a0"></a><a class="code hl_class" href="../../d4/de3/classVolumeControl.html">VolumeControl&lt;2&gt;</a> volume {{&amp;mixer_L, &amp;mixer_R}, A0, 1.0};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  volume.<a id="a1" name="a1"></a><a class="code hl_function" href="../../d4/de3/classVolumeControl.html#a7c3e14d99bd3dc0e3670d6956dafcaf2">begin</a>();</div>
<div class="line">  <span class="comment">// Add a dead zone if you can&#39;t get the volume all the way to zero</span></div>
<div class="line">  <span class="comment">// volume.map([](analog_t i) -&gt; analog_t {</span></div>
<div class="line">  <span class="comment">//   const analog_t lower = 0 + 10;</span></div>
<div class="line">  <span class="comment">//   const analog_t upper = 1023 - 10;</span></div>
<div class="line">  <span class="comment">//   return map(constrain(i, lower, upper), lower, upper, 0, 1023);</span></div>
<div class="line">  <span class="comment">// });</span></div>
<div class="line">  AudioMemory(6);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  volume.update();</div>
<div class="line">}</div>
<div class="ttc" id="aControl__Surface_8h_html"><div class="ttname"><a href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a></div><div class="ttdoc">The main header file that includes all Control-Surface header files.</div></div>
<div class="ttc" id="aclassVolumeControl_html"><div class="ttname"><a href="../../d4/de3/classVolumeControl.html">VolumeControl</a></div><div class="ttdoc">A class for controlling the volume of AudioMixer4 objects using a potentiometer.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d51/VolumeControl_8hpp_source.html#l00023">VolumeControl.hpp:23</a></div></div>
<div class="ttc" id="aclassVolumeControl_html_a7c3e14d99bd3dc0e3670d6956dafcaf2"><div class="ttname"><a href="../../d4/de3/classVolumeControl.html#a7c3e14d99bd3dc0e3670d6956dafcaf2">VolumeControl::begin</a></div><div class="ttdeci">void begin() override</div><div class="ttdoc">Initialize.</div><div class="ttdef"><b>Definition</b> <a href="../../da/d51/VolumeControl_8hpp_source.html#l00056">VolumeControl.hpp:56</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
