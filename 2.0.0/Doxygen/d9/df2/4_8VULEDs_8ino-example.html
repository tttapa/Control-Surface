<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: 4.VULEDs.ino</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<script type="text/javascript" src="../../darkmode_toggle.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Roboto:wght@400&family=Roboto:wght@500&display=swap" rel="stylesheet">
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Control Surface<span id="projectnumber">&#160;<code><a href="/Control-Surface/">2.0.0</a></code></span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">4.VULEDs.ino</div></div>
</div><!--header-->
<div class="contents">
<h1><a class="anchor" id="autotoc_md4vuleds"></a>
4.VULEDs</h1>
<p>This example demonstrates the use of the VULEDs class that displays the VU or level meters from your DAW as an LED bar graph.</p>
<p>Shift registers are used to drive the LEDs.</p>
<dl class="section user"><dt>Boards: <b class="boards-info" title="Control Surface&apos;s automated continuous integration workflows regularly verify that this example compiles successfully for the following boards. The list is not exhaustive, and the example will most likely work on other boards as well (perhaps requiring slight modifications).">ðŸ›ˆ</b> </dt><dd>AVR, AVR USB, Nano Every, Nano 33 IoT, Nano 33 BLE, UNO R4, Pi Pico, Due, Teensy 3.x, ESP8266, ESP32</dd></dl>
<h2><a class="anchor" id="connections-69"></a>
Connections</h2>
<ul>
<li>SS: 74HC595 ST_CP</li>
<li>MOSI: 74HC595 DS</li>
<li>SCK: 74HC595 SH_CP</li>
<li>A0: Push button (to ground, internal pull-up resistor will be used)</li>
</ul>
<p>Connect an LED (and series resistor) between each of the first 12 outputs of the shift registers and ground.</p>
<p>Remember to connect the enable pin of the shift register to ground and the master reset pin to Vcc in order to enable it. <br  />
</p>
<h2><a class="anchor" id="behavior-72"></a>
Behavior</h2>
<p>The LEDs display the level of the first track in your DAW. <br  />
 When the push button is pressed, the VU meter switches from bar mode to dot mode and back.</p>
<h2><a class="anchor" id="mapping-42"></a>
Mapping</h2>
<p>Map the Arduino as a Mackie Control Universal in your DAW.</p>
<p>Written by PieterP, 2019-12-09 <br  />
 <a href="https://github.com/tttapa/Control-Surface">https://github.com/tttapa/Control-Surface</a></p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><a id="_a0" name="_a0"></a><a class="code hl_class" href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a> midi;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate two daisy-chained shift register with the SPI slave select pin as</span></div>
<div class="line"><span class="comment">// latch pin, most significant bit first, and a total of 16 outputs.</span></div>
<div class="line">SPIShiftRegisterOut&lt;16&gt; sreg {SPI, SS, MSBFIRST};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate a VULEDs object with 12 LEDs.</span></div>
<div class="line"><a id="_a1" name="_a1"></a><a class="code hl_class" href="../../df/d36/classMCU_1_1VULEDs.html">MCU::VULEDs&lt;12&gt;</a> vu {</div>
<div class="line">  sreg.pins().slice&lt;0, 11&gt;(), <span class="comment">// first 12 pins of the shift registers</span></div>
<div class="line">  1,                          <span class="comment">// track number [1, 8]</span></div>
<div class="line">  <a id="a2" name="a2"></a><a class="code hl_variable" href="../../d6/d98/namespaceMCU_1_1VUDecay.html#ab8e20bc4798982b19f31c569b8dbb7db">MCU::VUDecay::Default</a>,      <span class="comment">// how long does it take for the meter to decay</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// If you don&#39;t want to use shift registers, you can just specify a list of pin</span></div>
<div class="line"><span class="comment">// numbers:</span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">//   MCU::VULEDs&lt;12&gt; vu {</span></div>
<div class="line"><span class="comment">//     {{2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13}}, // Arduino pin numbers</span></div>
<div class="line"><span class="comment">//     1,                      // track number [1, 8]</span></div>
<div class="line"><span class="comment">//     MCU::VUDecay::Default,  // how long does it take for the meter to decay</span></div>
<div class="line"><span class="comment">//   };</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// You can also use a different number of LEDs, but keep in mind that the MCU</span></div>
<div class="line"><span class="comment">// protocol sends the level on a scale from 0 to 12.</span></div>
<div class="line"><span class="comment">// If you use 24 LEDs, for example, the LEDs will turn on in groups of 2 at a</span></div>
<div class="line"><span class="comment">// time.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Push button to switch between dot and bar mode.</span></div>
<div class="line">Button dotBarModeButton = A0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">  <a id="a3" name="a3"></a><a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a id="a4" name="a4"></a><a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>();</div>
<div class="line">  dotBarModeButton.<a id="a5" name="a5"></a><a class="code hl_function" href="../../d0/d32/structAH_1_1Array.html#a90a285d3deb303b8ce684a1e4fdfe032">begin</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a id="a6" name="a6"></a><a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">  <span class="keywordflow">if</span> (dotBarModeButton.update() == Button::Falling) <span class="comment">// when button is pressed</span></div>
<div class="line">    vu.toggleMode(); <span class="comment">// toggle between dot and bar mode</span></div>
<div class="line">}</div>
<div class="ttc" id="aControl__Surface_8h_html"><div class="ttname"><a href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a></div><div class="ttdoc">The main header file that includes all Control-Surface header files.</div></div>
<div class="ttc" id="aControl__Surface__Class_8cpp_html_af7a5d250297d82b2b29605dd7ac250df"><div class="ttname"><a href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a></div><div class="ttdeci">Control_Surface_ &amp; Control_Surface</div><div class="ttdoc">A predefined instance of the Control Surface to use in the Arduino sketches.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00338">Control_Surface_Class.cpp:338</a></div></div>
<div class="ttc" id="aclassControl__Surface___html_ab0bdf5cca484fb2ba637c39384b27fb2"><div class="ttname"><a href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">Control_Surface_::begin</a></div><div class="ttdeci">void begin()</div><div class="ttdoc">Initialize the Control_Surface.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00022">Control_Surface_Class.cpp:22</a></div></div>
<div class="ttc" id="aclassControl__Surface___html_afe461d27b9c48d5921c00d521181f12f"><div class="ttname"><a href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">Control_Surface_::loop</a></div><div class="ttdeci">void loop()</div><div class="ttdoc">Update all MIDI elements, send MIDI events and read MIDI input.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00071">Control_Surface_Class.cpp:71</a></div></div>
<div class="ttc" id="aclassMCU_1_1VULEDs_html"><div class="ttname"><a href="../../df/d36/classMCU_1_1VULEDs.html">MCU::VULEDs</a></div><div class="ttdoc">A MIDI input element that represents a Mackie Control Universal VU meter and displays its value using...</div><div class="ttdef"><b>Definition</b> <a href="../../de/d3d/VULEDs_8hpp_source.html#l00043">VULEDs.hpp:43</a></div></div>
<div class="ttc" id="aclassUSBMIDI__Interface_html"><div class="ttname"><a href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a></div><div class="ttdoc">A class for MIDI interfaces sending MIDI messages over a USB MIDI connection.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d64/USBMIDI__Interface_8hpp_source.html#l00164">USBMIDI_Interface.hpp:165</a></div></div>
<div class="ttc" id="anamespaceMCU_1_1VUDecay_html_ab8e20bc4798982b19f31c569b8dbb7db"><div class="ttname"><a href="../../d6/d98/namespaceMCU_1_1VUDecay.html#ab8e20bc4798982b19f31c569b8dbb7db">MCU::VUDecay::Default</a></div><div class="ttdeci">constexpr unsigned int Default</div><div class="ttdoc">Decay one segment/block every 150 ms if no new values are received.</div><div class="ttdef"><b>Definition</b> <a href="../../db/dda/VU_8hpp_source.html#l00179">VU.hpp:179</a></div></div>
<div class="ttc" id="astructAH_1_1Array_html_a90a285d3deb303b8ce684a1e4fdfe032"><div class="ttname"><a href="../../d0/d32/structAH_1_1Array.html#a90a285d3deb303b8ce684a1e4fdfe032">AH::Array::begin</a></div><div class="ttdeci">T * begin()</div><div class="ttdoc">Get a pointer to the first element.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d76/Array_8hpp_source.html#l00074">Array.hpp:74</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
