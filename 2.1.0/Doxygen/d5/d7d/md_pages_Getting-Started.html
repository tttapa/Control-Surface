<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Control Surface: Getting Started</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
<script type="text/javascript" src="../../darkmode_toggle.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&family=Roboto:wght@400&family=Roboto:wght@500&display=swap" rel="stylesheet">
<link href="../../custom_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Control Surface<span id="projectnumber">&#160;<code><a href="/Control-Surface/">2.1.0</a></code></span>
   </div>
   <div id="projectbrief">MIDI Control Surface library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Getting Started</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#installation">Installation</a></li>
<li class="level1"><a href="#first-output">First Output: Creating a Basic MIDI Controller Sketch</a><ul><li class="level2"><a href="#autotoc_md1-include-the-library">1. Include the library</a></li>
<li class="level2"><a href="#first-output-midi-interface">2. Instantiate a MIDI Interface</a></li>
<li class="level2"><a href="#first-output-extio">3. Add Extended Input/Output elements (optional)</a></li>
<li class="level2"><a href="#autotoc_md4-add-midi-control-elements">4. Add MIDI Control Elements</a></li>
<li class="level2"><a href="#first-output-init">5. Initialize the Control Surface</a></li>
<li class="level2"><a href="#first-output-loop">6. Continuously Update the Control Surface</a></li>
<li class="level2"><a href="#the-finished-sketch">The finished sketch</a></li>
</ul>
</li>
<li class="level1"><a href="#first-input">First Input: Getting Feedback from the MIDI Software</a><ul><li class="level2"><a href="#autotoc_md1-include-the-library-1">1. Include the library</a></li>
<li class="level2"><a href="#autotoc_md2-instantiate-a-midi-interface">2. Instantiate a MIDI Interface</a></li>
<li class="level2"><a href="#autotoc_md3-add-extended-inputoutput-elements-optional">3. Add Extended Input/Output elements (optional)</a></li>
<li class="level2"><a href="#autotoc_md4-add-midi-control-elements-1">4. Add MIDI Control Elements</a></li>
<li class="level2"><a href="#autotoc_md5-initialize-the-control-surface">5. Initialize the Control Surface</a></li>
<li class="level2"><a href="#autotoc_md6-continuously-update-the-control-surface">6. Continuously Update the Control Surface</a></li>
<li class="level2"><a href="#the-finished-sketch-1">The finished sketch</a></li>
</ul>
</li>
<li class="level1"><a href="#getting-started_md-troubleshooting">Troubleshooting</a></li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_pages_2Getting-Started"></a></p>
<h1><a class="anchor" id="installation"></a>
Installation</h1>
<p>Instructions on how to install the library and its dependencies can be found on the page <a class="el" href="../../d8/da8/md_pages_Installation.html#md_pages_2Installation">Installation</a>.</p>
<h1><a class="anchor" id="first-output"></a>
First Output: Creating a Basic MIDI Controller Sketch</h1>
<h2><a class="anchor" id="autotoc_md1-include-the-library"></a>
1. Include the library</h2>
<p>Include the library so that you have access to all the classes and functions it provides.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="ttc" id="aControl__Surface_8h_html"><div class="ttname"><a href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a></div><div class="ttdoc">The main header file that includes all Control-Surface header files.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="first-output-midi-interface"></a>
2. Instantiate a MIDI Interface</h2>
<p>If you want to send out or receive MIDI messages, you have to define at least one MIDI interface. If you don't do that, you'll get an error when calling <code>Control_Surface.begin()</code>.</p>
<p>There are many different MIDI interfaces to choose from:</p>
<ul>
<li><code><a class="el" href="../../de/d05/classUSBMIDI__Interface.html" title="A class for MIDI interfaces sending MIDI messages over a USB MIDI connection.">USBMIDI_Interface</a></code>: On boards that support MIDI over USB natively, this will do exactly what you'd expect: You just have to plug it into your computer, and it shows up as a MIDI device. On Arduinos without native USB capabilities (e.g. UNO or MEGA), you have to use custom firmware for the ATmega16U2. See <a class="el" href="../../d8/d4a/md_pages_MIDI-over-USB.html">MIDI over USB</a> for details.</li>
<li><code><a class="el" href="../../d9/d78/classHardwareSerialMIDI__Interface.html" title="A class for MIDI interfaces sending and receiving MIDI messages over a Hardware Serial port.">HardwareSerialMIDI_Interface</a></code>: This interface will send and receive MIDI messages over a hardware UART. You can use it for MIDI over a 5-pin DIN connector, for example.</li>
<li><code><a class="el" href="../../dc/dff/classHairlessMIDI__Interface.html" title="A class for MIDI Interfaces sending and receiving data over the USB Serial CDC connection for the use...">HairlessMIDI_Interface</a></code>: If you have an Arduino without native USB support, an easy way to get the MIDI messages from your Arduino to your computer is the <a href="https://projectgus.github.io/hairless-midiserial/">Hairless MIDI&lt;-&gt;Serial Bridge</a>. In that case, you can use this MIDI interface. The default baud rate is 115200 symbols per second.</li>
<li><code><a class="el" href="../../df/d43/structBluetoothMIDI__Interface.html" title="A class for MIDI interfaces sending MIDI messages over a Bluetooth Low Energy (BLE) connection.">BluetoothMIDI_Interface</a></code>: If you have a board that supports Bluetooth Low Energy (BLE), such as an ESP32 or a Raspberry Pi Pico W, you can send and receive MIDI messages over Bluetooth. See <a class="el" href="../../db/d99/md_pages_MIDI-over-BLE.html">MIDI over BLE</a> for details.</li>
<li><code><a class="el" href="../../de/d2d/classUSBDebugMIDI__Interface.html" title="A class for debug MIDI interfaces sending and receiving human-readable MIDI messages over the USB CDC...">USBDebugMIDI_Interface</a></code>: Debugging MIDI Controllers can be very cumbersome. There are MIDI monitors available, but you have to reconnect every time you upload a new sketch, and sending MIDI to the Arduino is not always easy. <br  />
 This interface is designed to help with that: It prints outgoing MIDI messages to the Serial port in a readable format, and it allows you to enter hexadecimal MIDI messages (as text) in the Serial monitor (e.g. <code>90 3C 7F</code> to turn on middle C).</li>
</ul>
<p>A complete overview of the available MIDI interfaces can be found in the <a class="el" href="../../dc/df0/group__MIDIInterfaces.html">MIDI Interfaces</a> module.</p>
<p>For now, we'll use the <code><a class="el" href="../../de/d05/classUSBMIDI__Interface.html" title="A class for MIDI interfaces sending MIDI messages over a USB MIDI connection.">USBMIDI_Interface</a></code> because it's probably the one you'll use in your final program. Do keep in mind that not all boards support MIDI over USB natively, for more details, see the <a class="el" href="../../d8/d4a/md_pages_MIDI-over-USB.html">MIDI over USB</a> page.</p>
<p>You can give the interface any name you want. Lacking originality, I'll choose <code>midi</code>. The name doesn't matter, and you don't need to use it afterwards, just defining the interface is enough, the Control Surface library will automatically detect and use it.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a> midi;</div>
<div class="ttc" id="aclassUSBMIDI__Interface_html"><div class="ttname"><a href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a></div><div class="ttdoc">A class for MIDI interfaces sending MIDI messages over a USB MIDI connection.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d64/USBMIDI__Interface_8hpp_source.html#l00164">USBMIDI_Interface.hpp:165</a></div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<b>Note</b>: some interfaces require additional parameters, for example, the <code><a class="el" href="../../de/d2d/classUSBDebugMIDI__Interface.html" title="A class for debug MIDI interfaces sending and receiving human-readable MIDI messages over the USB CDC...">USBDebugMIDI_Interface</a></code> needs to know the baud rate. <br  />
 In that case, you can instantiate it as follows: <br  />
 <code><a class="el" href="../../de/d2d/classUSBDebugMIDI__Interface.html" title="A class for debug MIDI interfaces sending and receiving human-readable MIDI messages over the USB CDC...">USBDebugMIDI_Interface</a> midi {115200};</code> </p>
</blockquote>
<p>For a more detailed discussion of MIDI interfaces and how to use them to send and receive MIDI message, have a look at the <a class="el" href="../../d3/df7/midi-tutorial.html">MIDI Tutorial</a>.</p>
<h2><a class="anchor" id="first-output-extio"></a>
3. Add Extended Input/Output elements (optional)</h2>
<p>If your MIDI Controller requires many in- or outputs, you'll run out of IO pins quite quickly. A solution is to use multiplexers or shift registers to expand the number of usable in- and outputs. <br  />
 The Control Surface library supports both of these options, and makes it easy to support other types of IO expanders in the future.</p>
<p>An overview of Extended Input/Output elements can be found in the <a class="el" href="../../db/dd3/group__AH__ExtIO.html">Extended Input/Output</a> module.</p>
<p>In this example, we'll use an 8-channel 74HC4051 analog multiplexer. This allows us to read eight analog inputs using just one analog pin on the Arduino, at the cost of only three digital output pins.</p>
<p>Each of the eight analog inputs of the multiplexer can be connected to the wiper of one potentiometer.</p>
<p>We'll connect the three address lines of the multiplexer (<code>S0</code>, <code>S1</code> and <code>S2</code>) to digital pins <code>3</code>, <code>4</code> and <code>5</code>. The output of the multiplexer goes to analog pin <code>A0</code>. Connect the enable pin (<code>Ä’</code>) to ground.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../d2/d94/classAH_1_1AnalogMultiplex.html">CD74HC4051</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a> { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">A0</a>, {3, 4, 5} };</div>
<div class="ttc" id="aclassAH_1_1AnalogMultiplex_html"><div class="ttname"><a href="../../d2/d94/classAH_1_1AnalogMultiplex.html">::AnalogMultiplex</a></div><div class="ttdoc">A class for reading multiplexed analog inputs.</div><div class="ttdef"><b>Definition</b> <a href="../../d7/def/AnalogMultiplex_8hpp_source.html#l00025">AnalogMultiplex.hpp:25</a></div></div>
<div class="ttc" id="agroup__AH__Containers_html_ga6ee13d5c260727ac6a7de2ee21cc76f9"><div class="ttname"><a href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">AH::copyAs</a></div><div class="ttdeci">Array&lt; T, N &gt; copyAs(const Array&lt; U, N &gt; &amp;src)</div><div class="ttdoc">Copy an Array to an Array of a different type.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/db6/ArrayHelpers_8hpp_source.html#l00105">ArrayHelpers.hpp:105</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4-add-midi-control-elements"></a>
4. Add MIDI Control Elements</h2>
<p>Now, we can specify the objects that read the input of the potentiometers and send out MIDI events accordingly.</p>
<p>I'll again refer to the documentation for an overview of all supported <a class="el" href="../../d7/dcd/group__MIDIOutputElements.html">MIDI Output Elements</a> (including potentiometers, switches, rotary encoders, etc.).</p>
<p>Let's define a single potentiometer on pin <code>A1</code> that sends out MIDI Control Change events. <br  />
 In the <a class="el" href="../../db/d32/classCCPotentiometer.html#a3370442e3c76182e353d1951016979fc">documentation</a>, you'll find that the first argument for the <code><a class="el" href="../../db/d32/classCCPotentiometer.html" title="A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...">CCPotentiometer</a></code> constructor is the analog pin number, and the second is the MIDI address. <br  />
 The MIDI address is a structure that consists of an address number, the MIDI channel, and the cable number. <br  />
 In this case, the address number is the controller number, which is a number from 0 to 119. The MIDI channel is a channel from <code>Channel_1</code> until <code>Channel_16</code>. We'll ignore the cable number for now, if you don't specifically set it, it'll just use the default cable. <br  />
 You can find more information about MIDI addresses in the <a class="el" href="../../d3/df7/midi-tutorial.html#midi_md-midi-addresses">MIDI Tutorial: MIDI addresses</a>.</p>
<p>For the MIDI controller numbers, you can use the <a class="el" href="../../d4/dbe/namespaceMIDI__CC.html">predefined constants</a>, or you can just use a number.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../db/d32/classCCPotentiometer.html">CCPotentiometer</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">potentiometer</a> { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">A1</a>, {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a>} };</div>
<div class="ttc" id="aChannel_8hpp_html_a40d189f24e13a7304f2c9094038588ae"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a></div><div class="ttdeci">constexpr Channel Channel_1</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00118">Channel.hpp:118</a></div></div>
<div class="ttc" id="aclassCCPotentiometer_html"><div class="ttname"><a href="../../db/d32/classCCPotentiometer.html">CCPotentiometer</a></div><div class="ttdoc">A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...</div><div class="ttdef"><b>Definition</b> <a href="../../d4/df0/CCPotentiometer_8hpp_source.html#l00019">CCPotentiometer.hpp:19</a></div></div>
<div class="ttc" id="anamespaceMIDI__CC_html_ac73258d1263f61f65fc27976b6aa9a64"><div class="ttname"><a href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a></div><div class="ttdeci">constexpr uint8_t Channel_Volume</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d43/Control__Change_8hpp_source.html#l00023">Control_Change.hpp:23</a></div></div>
</div><!-- fragment --> <div class="fragment"><div class="line"><a class="code hl_class" href="../../db/d32/classCCPotentiometer.html">CCPotentiometer</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">potentiometer</a> { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">A1</a>, {7, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a>} };</div>
</div><!-- fragment --><p>In our case, we don't want a single potentiometer, we want eight. It's much easier to define them in an <a href="https://www.learncpp.com/cpp-tutorial/introduction-to-c-style-arrays/">array</a>. <br  />
 Also note how we declare that the potentiometers are connected to the the pins of the multiplexer we defined in the previous step.</p>
<p>To go from the initialization of a single potentiometer to the initialization of an array of potentiometers, we just create a comma-separated list of initializers for single elements, and then we add another pair of curly braces around it. <br  />
 Compare this to the initialization of an array of integers: to initialize a single integer, you use <code>int i = 42;</code> and to initialize an array of integers, you use <code>int ii[] = {42, 43, ...};</code>. Analogously, to initialize a single potentiometer object, you use <code><a class="el" href="../../db/d32/classCCPotentiometer.html" title="A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...">CCPotentiometer</a> pot = {pin, address};</code> and to initialize an array of potentiometers, you use <code><a class="el" href="../../db/d32/classCCPotentiometer.html" title="A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...">CCPotentiometer</a> pots[] = { {pin, address}, {pin, address}, ... };</code>. It is recommended to leave out the equal sign (<code>=</code>), because this will result in more meaningful error messages if you get any of the arguments wrong: <code><a class="el" href="../../db/d32/classCCPotentiometer.html" title="A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...">CCPotentiometer</a> pots[] { {pin, address}, {pin, address}, ... };</code>.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b>: The first pin is of the multiplexer is <code>pin(0)</code>, not <code>pin(1)</code>. </p>
</blockquote>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../db/d32/classCCPotentiometer.html">CCPotentiometer</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">volumePotentiometers</a>[] {</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(0), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(1), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a6002e13e1e175446065a3eb90373fcfd">Channel_2</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(2), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a1c32ffd7bfc55fa946f967d4d7fcba35">Channel_3</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(3), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#ab5ffea9d2f388fc094046fbe8cbf6b1b">Channel_4</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(4), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#ad55a9954f18a5b89f78e9d332930bfb1">Channel_5</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(5), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a12a8004e400b6460414618990b43b924">Channel_6</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(6), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a06c280a3f8771fbcb217713f5b2121c1">Channel_7</a>} },</div>
<div class="line">    { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(7), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#af44b83db16bf73e5229fc2c3f2995f74">Channel_8</a>} },</div>
<div class="line">};</div>
<div class="ttc" id="aChannel_8hpp_html_a06c280a3f8771fbcb217713f5b2121c1"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a06c280a3f8771fbcb217713f5b2121c1">Channel_7</a></div><div class="ttdeci">constexpr Channel Channel_7</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00124">Channel.hpp:124</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_a12a8004e400b6460414618990b43b924"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a12a8004e400b6460414618990b43b924">Channel_6</a></div><div class="ttdeci">constexpr Channel Channel_6</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00123">Channel.hpp:123</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_a1c32ffd7bfc55fa946f967d4d7fcba35"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a1c32ffd7bfc55fa946f967d4d7fcba35">Channel_3</a></div><div class="ttdeci">constexpr Channel Channel_3</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00120">Channel.hpp:120</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_a6002e13e1e175446065a3eb90373fcfd"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a6002e13e1e175446065a3eb90373fcfd">Channel_2</a></div><div class="ttdeci">constexpr Channel Channel_2</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00119">Channel.hpp:119</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_ab5ffea9d2f388fc094046fbe8cbf6b1b"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#ab5ffea9d2f388fc094046fbe8cbf6b1b">Channel_4</a></div><div class="ttdeci">constexpr Channel Channel_4</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00121">Channel.hpp:121</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_ad55a9954f18a5b89f78e9d332930bfb1"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#ad55a9954f18a5b89f78e9d332930bfb1">Channel_5</a></div><div class="ttdeci">constexpr Channel Channel_5</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00122">Channel.hpp:122</a></div></div>
<div class="ttc" id="aChannel_8hpp_html_af44b83db16bf73e5229fc2c3f2995f74"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#af44b83db16bf73e5229fc2c3f2995f74">Channel_8</a></div><div class="ttdeci">constexpr Channel Channel_8</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00125">Channel.hpp:125</a></div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<b>Note</b>: Some other MIDI Control Elements might not need an address number, or they might not need a channel. In that case, you just leave out the optional parts that you don't need. <br  />
 For example, a <code><a class="el" href="../../da/d6a/classPBPotentiometer.html" title="A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...">PBPotentiometer</a></code> doesn't need an address number, just a channel, so you can instantiate it as follows: </p><div class="fragment"><div class="line"><a class="code hl_class" href="../../da/d6a/classPBPotentiometer.html">PBPotentiometer</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">potentiometer</a> { <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">A1</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a9b9740bab6ce97ab3f60896754d667c6">Channel_9</a> };</div>
<div class="ttc" id="aChannel_8hpp_html_a9b9740bab6ce97ab3f60896754d667c6"><div class="ttname"><a href="../../d7/d42/Channel_8hpp.html#a9b9740bab6ce97ab3f60896754d667c6">Channel_9</a></div><div class="ttdeci">constexpr Channel Channel_9</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d42/Channel_8hpp_source.html#l00126">Channel.hpp:126</a></div></div>
<div class="ttc" id="aclassPBPotentiometer_html"><div class="ttname"><a href="../../da/d6a/classPBPotentiometer.html">PBPotentiometer</a></div><div class="ttdoc">A class of MIDIOutputElements that read the analog input from a potentiometer or fader,...</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d74/PBPotentiometer_8hpp_source.html#l00022">PBPotentiometer.hpp:22</a></div></div>
</div><!-- fragment --> </blockquote>
<h2><a class="anchor" id="first-output-init"></a>
5. Initialize the Control Surface</h2>
<p>There's a lot to be done in the <code>setup</code>: The MIDI interface has to be initialized, all pins must be set to the correct mode, etc. <br  />
 Luckily, the Control Surface Library handles almost all of it for you.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">setup</a>() {</div>
<div class="line">    <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aControl__Surface__Class_8cpp_html_af7a5d250297d82b2b29605dd7ac250df"><div class="ttname"><a href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a></div><div class="ttdeci">Control_Surface_ &amp; Control_Surface</div><div class="ttdoc">A predefined instance of the Control Surface to use in the Arduino sketches.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00338">Control_Surface_Class.cpp:338</a></div></div>
<div class="ttc" id="aclassControl__Surface___html_ab0bdf5cca484fb2ba637c39384b27fb2"><div class="ttname"><a href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">Control_Surface_::begin</a></div><div class="ttdeci">void begin()</div><div class="ttdoc">Initialize the Control_Surface.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00022">Control_Surface_Class.cpp:22</a></div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<b>Note</b>: If you forget to define a MIDI interface, <code>Control_Surface.begin()</code> will raise an error and the on-board LED will start blinking. <br  />
 Other errors will also be indicated this way. <br  />
 If you don't know why this happens, you should enable debug information as described in the <a class="el" href="#getting-started_md-troubleshooting">Troubleshooting</a> section below, and inspect the output in the Serial Monitor. <br  />
 If you cannot fix the issue based on the documentation, source code and <a class="el" href="../../da/dc1/FAQ.html">Frequently Asked Questions</a> alone, feel free to <a href="https://github.com/tttapa/Control-Surface/discussions">start a discussion on GitHub</a> </p>
</blockquote>
<h2><a class="anchor" id="first-output-loop"></a>
6. Continuously Update the Control Surface</h2>
<p>Now that everything is set up, you can just update the Control Surface forever. It will refresh all inputs and send the appropriate MIDI messages if any of the inputs change.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">    <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassControl__Surface___html_afe461d27b9c48d5921c00d521181f12f"><div class="ttname"><a href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">Control_Surface_::loop</a></div><div class="ttdeci">void loop()</div><div class="ttdoc">Update all MIDI elements, send MIDI events and read MIDI input.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d38/Control__Surface__Class_8cpp_source.html#l00071">Control_Surface_Class.cpp:71</a></div></div>
</div><!-- fragment --><blockquote class="doxtable">
<p>&zwj;<b>Note</b>: Using blocking code like delays will interfere with the Control Surface, so try to use <a href="https://www.arduino.cc/en/Tutorial/BlinkWithoutDelay">Blink Without Delay</a> techniques instead. </p>
</blockquote>
<h2><a class="anchor" id="the-finished-sketch"></a>
The finished sketch</h2>
<p>That's it! <br  />
 Now you can just upload the sketch to your Arduino, open up your favorite audio software, map the potentiometers, and start playing!</p>
<div class="fragment"><div class="line"><span class="comment">// Include the library</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate a MIDI Interface to use</span></div>
<div class="line"><a class="code hl_class" href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a> midi;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate an analog multiplexer</span></div>
<div class="line"><a class="code hl_class" href="../../d2/d94/classAH_1_1AnalogMultiplex.html">CD74HC4051</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a> {</div>
<div class="line">  <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">A0</a>,       <span class="comment">// Analog input pin</span></div>
<div class="line">  {3, 4, 5} <span class="comment">// Address pins S0, S1, S2</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create an array of potentiometers that send out</span></div>
<div class="line"><span class="comment">// MIDI Control Change messages when you turn the</span></div>
<div class="line"><span class="comment">// potentiometers connected to the eight input pins of</span></div>
<div class="line"><span class="comment">// the multiplexer</span></div>
<div class="line"><a class="code hl_class" href="../../db/d32/classCCPotentiometer.html">CCPotentiometer</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">volumePotentiometers</a>[] {</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(0), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(1), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a6002e13e1e175446065a3eb90373fcfd">Channel_2</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(2), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a1c32ffd7bfc55fa946f967d4d7fcba35">Channel_3</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(3), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#ab5ffea9d2f388fc094046fbe8cbf6b1b">Channel_4</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(4), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#ad55a9954f18a5b89f78e9d332930bfb1">Channel_5</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(5), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a12a8004e400b6460414618990b43b924">Channel_6</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(6), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a06c280a3f8771fbcb217713f5b2121c1">Channel_7</a>}},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">mux</a>.pin(7), {<a class="code hl_variable" href="../../d4/dbe/namespaceMIDI__CC.html#ac73258d1263f61f65fc27976b6aa9a64">MIDI_CC::Channel_Volume</a>, <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#af44b83db16bf73e5229fc2c3f2995f74">Channel_8</a>}},</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize the Control Surface</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">setup</a>() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update the Control Surface</span></div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="first-input"></a>
First Input: Getting Feedback from the MIDI Software</h1>
<p>Unlike the MIDI Controller library, the Control Surface library does support MIDI input. <br  />
 This example shows how to use the <code>NoteLED</code> class to turn on and off LEDs when MIDI Note On/Off messages are received. <br  />
 The example shows the use of a shift register to drive the LEDs, but you can of course use any pins you want.</p>
<p> 
<iframe width="560" height="315"
src="https://www.youtube.com/embed/u1IbYXPT6mM?loop=1" frameborder="0"
allow="accelerometer; autoplay; encrypted-media; gyroscope;
picture-in-picture" allowfullscreen></iframe>
</p>
<h2><a class="anchor" id="autotoc_md1-include-the-library-1"></a>
1. Include the library</h2>
<p>Include the library so that you have access to all the classes and functions.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md2-instantiate-a-midi-interface"></a>
2. Instantiate a MIDI Interface</h2>
<p>See <a class="el" href="#first-output-midi-interface">First Output: Instantiate a MIDI Interface</a>.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a> midi;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md3-add-extended-inputoutput-elements-optional"></a>
3. Add Extended Input/Output elements (optional)</h2>
<p>See <a class="el" href="#first-output-extio">First Output: Add Extended Input/Output elements</a>.</p>
<p>In this example, we'll use a 74HC595 8-bit serial in/parallel out shift register. This allows us to drive eight LEDs using just the SPI bus and a single digital pin. You can daisy chain as many shift registers as you want, without requiring any more pins.</p>
<p>Each of the eight outputs of the shift register can be connected to the anode of an LED. Connect the cathodes to ground through a current-limiting resistor.</p>
<p>Connect the clock input (<code>SH_CP</code> or <code>SRCLK</code>) of the shift register to the Arduino's SCK pin, the serial data input (<code>DS</code> or <code>SER</code>) of the shift register to the Arduino's MOSI pin, and the latch pin (<code>ST_CP</code> or <code>RCLK</code>) of the shift register to digital pin 10 of the Arduino. Connect the Output Enable pin (<code>OE</code>) of the shift register to ground, and the Master Reset (MR) pin of the shift register to Vcc to enable it.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../d5/d09/classAH_1_1SPIShiftRegisterOut.html">SPIShiftRegisterOut&lt;8&gt;</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a> {</div>
<div class="line">  <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">SPI</a>,      <span class="comment">// SPI interface to use</span></div>
<div class="line">  10,       <span class="comment">// Latch pin (ST_CP)</span></div>
<div class="line">  <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">MSBFIRST</a>, <span class="comment">// Bit order</span></div>
<div class="line">};</div>
<div class="ttc" id="aclassAH_1_1SPIShiftRegisterOut_html"><div class="ttname"><a href="../../d5/d09/classAH_1_1SPIShiftRegisterOut.html">::SPIShiftRegisterOut</a></div><div class="ttdoc">A class for serial-in/parallel-out shift registers, like the 74HC595 that are connected to the SPI bu...</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d88/SPIShiftRegisterOut_8hpp_source.html#l00028">SPIShiftRegisterOut.hpp:28</a></div></div>
</div><!-- fragment --><p>The <code>8</code> between angle brackets (<code>&lt;&gt;</code>) is the number of bits of the shift register. If you daisy chain two 8-bit shift registers together, you would use <code>16</code> instead of <code>8</code>, for example. <br  />
 The bit order determines which pin of the shift register is the first pin in the program. <code>MSBFIRST</code> means "most significant bit first". You can also use <code>LSBFIRST</code> (least significant bit first).</p>
<h2><a class="anchor" id="autotoc_md4-add-midi-control-elements-1"></a>
4. Add MIDI Control Elements</h2>
<p>Now, we can specify the objects that listen for MIDI input, and update the status of the LEDs accordingly.</p>
<p>I'll refer to the overview of <a class="el" href="../../df/d8b/group__MIDIInputElements.html">MIDI Input Elements</a>.</p>
<p>Let's define a single LED on pin <code>13</code> that listens for MIDI Note events for a middle C on channel 1. <br  />
 In the <a class="el" href="../../d7/de4/group__midi-input-elements-leds.html#gacbe10d918c7d5f3f2121a0157bf14f5a">documentation</a>, you'll find that the first argument for the <code>NoteLED</code> constructor is the number of the pin with the LED connected, and the second is the MIDI address. <br  />
 The MIDI address is a structure that consists of an address number, the MIDI channel, and the cable number. <br  />
 In this case, the address number is the note number, which is a number from 0 to 127. The MIDI channel is a channel from <code>Channel_1</code> until <code>Channel_16</code>. We'll ignore the cable number for now, if you don't specifically set it, it'll just use the default cable. <br  />
</p>
<p>For the MIDI note numbers, you can use the note constants and the <code>note</code> function in the <a class="el" href="../../d7/d78/namespaceMIDI__Notes.html">MIDI_Notes</a> namespace, or you can just use a number.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../d9/d55/classNoteCCKPLED.html">NoteLED</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">noteLed</a> { 13, {<a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[4], <a class="code hl_variable" href="../../d7/d42/Channel_8hpp.html#a40d189f24e13a7304f2c9094038588ae">Channel_1</a>} };  <span class="comment">// C4 = middle C</span></div>
<div class="ttc" id="aclassNoteCCKPLED_html"><div class="ttname"><a href="../../d9/d55/classNoteCCKPLED.html">NoteCCKPLED</a></div><div class="ttdoc">Generic base class for classes that listen for MIDI Note, Control Change and Key Pressure events on a...</div><div class="ttdef"><b>Definition</b> <a href="../../d2/df7/NoteCCKPLED_8hpp_source.html#l00020">NoteCCKPLED.hpp:20</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_adc612a1e4e057463777480eabc3fb0ca"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a></div><div class="ttdeci">constexpr Note C</div><div class="ttdoc">C (Do)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00056">Notes.hpp:56</a></div></div>
</div><!-- fragment --><p>In our case, we don't want a single LED, we want eight. It's much easier to define them in an array. <br  />
 Also note how we state that it should use the pins of the shift register we defined in the previous step. We omit the channel here, so it'll just use the default channel, <code>Channel_1</code>.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b>: The first pin is <code>pin(0)</code>, not <code>pin(1)</code>. </p>
</blockquote>
<div class="fragment"><div class="line"><a class="code hl_class" href="../../d9/d55/classNoteCCKPLED.html">NoteLED</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">leds</a>[] {</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(0), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(1), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#af5d9fc75ec408f3b701c8a6a53b48eed">MIDI_Notes::D</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(2), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#abeea08ce279b402b780ad083ef08c09e">MIDI_Notes::E</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(3), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#a3d1322b4c57328a965f796ba0a9aca88">MIDI_Notes::F</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(4), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#a96b1b9498229f65757b410e4377ae384">MIDI_Notes::G</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(5), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#ad887f404135f1eee183e6f6e465fca25">MIDI_Notes::A</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(6), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#ad4db6c301a5bc503bb0ec5a9645090b0">MIDI_Notes::B</a>[4]},</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(7), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[5]},</div>
<div class="line">};</div>
<div class="ttc" id="anamespaceMIDI__Notes_html_a3d1322b4c57328a965f796ba0a9aca88"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#a3d1322b4c57328a965f796ba0a9aca88">MIDI_Notes::F</a></div><div class="ttdeci">constexpr Note F</div><div class="ttdoc">F (Fa)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00061">Notes.hpp:61</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_a96b1b9498229f65757b410e4377ae384"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#a96b1b9498229f65757b410e4377ae384">MIDI_Notes::G</a></div><div class="ttdeci">constexpr Note G</div><div class="ttdoc">G (Sol)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00063">Notes.hpp:63</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_abeea08ce279b402b780ad083ef08c09e"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#abeea08ce279b402b780ad083ef08c09e">MIDI_Notes::E</a></div><div class="ttdeci">constexpr Note E</div><div class="ttdoc">E (Mi)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00060">Notes.hpp:60</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_ad4db6c301a5bc503bb0ec5a9645090b0"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#ad4db6c301a5bc503bb0ec5a9645090b0">MIDI_Notes::B</a></div><div class="ttdeci">constexpr Note B</div><div class="ttdoc">B (Si)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00067">Notes.hpp:67</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_ad887f404135f1eee183e6f6e465fca25"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#ad887f404135f1eee183e6f6e465fca25">MIDI_Notes::A</a></div><div class="ttdeci">constexpr Note A</div><div class="ttdoc">A (La)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00065">Notes.hpp:65</a></div></div>
<div class="ttc" id="anamespaceMIDI__Notes_html_af5d9fc75ec408f3b701c8a6a53b48eed"><div class="ttname"><a href="../../d7/d78/namespaceMIDI__Notes.html#af5d9fc75ec408f3b701c8a6a53b48eed">MIDI_Notes::D</a></div><div class="ttdeci">constexpr Note D</div><div class="ttdoc">D (Re)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc5/Notes_8hpp_source.html#l00058">Notes.hpp:58</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md5-initialize-the-control-surface"></a>
5. Initialize the Control Surface</h2>
<p>See <a class="el" href="#first-output-init">First Output: Initialize the Control Surface</a>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">setup</a>() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md6-continuously-update-the-control-surface"></a>
6. Continuously Update the Control Surface</h2>
<p>See <a class="el" href="#first-output-loop">First Output: Continuously Update the Control Surface</a>.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="the-finished-sketch-1"></a>
The finished sketch</h2>
<p>That's it! <br  />
 Now you can just upload the sketch to your Arduino, open up your favorite audio software, redirect the MIDI output to the Arduino, and start playing!</p>
<div class="fragment"><div class="line"><span class="comment">// Include the library</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate a MIDI Interface to use</span></div>
<div class="line"><a class="code hl_class" href="../../de/d05/classUSBMIDI__Interface.html">USBMIDI_Interface</a> midi;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Instantiate a shift register as output for the LEDs</span></div>
<div class="line"><a class="code hl_class" href="../../d5/d09/classAH_1_1SPIShiftRegisterOut.html">SPIShiftRegisterOut&lt;8&gt;</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a> {</div>
<div class="line">  <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">SPI</a>,      <span class="comment">// SPI interface to use</span></div>
<div class="line">  10,       <span class="comment">// Latch pin (ST_CP)</span></div>
<div class="line">  <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">MSBFIRST</a>, <span class="comment">// Byte order</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create an array of LEDs that listen to MIDI Note messages, turning on and off</span></div>
<div class="line"><span class="comment">// the LEDs connected to the eight output pins of the shift register</span></div>
<div class="line"><a class="code hl_class" href="../../d9/d55/classNoteCCKPLED.html">NoteLED</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">leds</a>[] {</div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(0), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[4]},  <span class="comment">// LED pin, address (note number, channel, cable)</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(1), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#af5d9fc75ec408f3b701c8a6a53b48eed">MIDI_Notes::D</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(2), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#abeea08ce279b402b780ad083ef08c09e">MIDI_Notes::E</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(3), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#a3d1322b4c57328a965f796ba0a9aca88">MIDI_Notes::F</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(4), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#a96b1b9498229f65757b410e4377ae384">MIDI_Notes::G</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(5), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#ad887f404135f1eee183e6f6e465fca25">MIDI_Notes::A</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(6), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#ad4db6c301a5bc503bb0ec5a9645090b0">MIDI_Notes::B</a>[4]},  <span class="comment">//</span></div>
<div class="line">  {<a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">sreg</a>.pin(7), <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[5]},  <span class="comment">//</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Initialize the Control Surface</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">setup</a>() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Update the Control Surface</span></div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="getting-started_md-troubleshooting"></a>
Troubleshooting</h1>
<p>If something goes wrong at run time, Control Surface will start blinking the on-board LED, with a pattern of two short flashes, followed by a longer pause, and a period of one second. You can enable debug output by defining the <code>DEBUG_OUT</code> macro in <code>~Arduino/libraries/Control-Surface/src/AH/Settings/Settings.hpp</code> as <code>Serial</code>, for example. This requires quite a bit of extra memory, so that might not be feasible on all boards, or you might have to simplify your sketch a bit.</p>
<p>If your sketch produces an error as soon as you call <code>Control_Surface.begin()</code>, you might not be able to open the Serial Monitor quickly enough to catch the error message, in that case, you can wait for the Serial connection to be opened before initializing Control Surface. For example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="../../db/dbf/Control__Surface_8h.html">Control_Surface.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Oops! We forgot to instantiate a MIDI interface!</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="../../d1/d9f/classNoteButton.html">NoteButton</a> button {2, <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[4]};</div>
<div class="line"><a class="code hl_class" href="../../d9/d55/classNoteCCKPLED.html">NoteLED</a> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">led</a> {13, <a class="code hl_variable" href="../../d7/d78/namespaceMIDI__Notes.html#adc612a1e4e057463777480eabc3fb0ca">MIDI_Notes::C</a>[4]};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="../../da/de8/group__AH__Containers.html#ga6ee13d5c260727ac6a7de2ee21cc76f9">setup</a>() {</div>
<div class="line"><span class="preprocessor">#ifdef DEBUG_OUT</span></div>
<div class="line">    <a class="code hl_define" href="../../d5/d4f/AH_2Settings_2Settings_8hpp.html#a7cc5a6d57623c456857b1ba01ce919ee">DEBUG_OUT</a>.begin(115200); <span class="comment">// Initialize the debug output</span></div>
<div class="line">    <span class="keywordflow">while</span> (!<a class="code hl_define" href="../../d5/d4f/AH_2Settings_2Settings_8hpp.html#a7cc5a6d57623c456857b1ba01ce919ee">DEBUG_OUT</a>);      <span class="comment">// and wait for it to become available</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#ab0bdf5cca484fb2ba637c39384b27fb2">begin</a>(); </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">    <a class="code hl_variable" href="../../d9/d38/Control__Surface__Class_8cpp.html#af7a5d250297d82b2b29605dd7ac250df">Control_Surface</a>.<a class="code hl_function" href="../../dc/d45/classControl__Surface__.html#afe461d27b9c48d5921c00d521181f12f">loop</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aAH_2Settings_2Settings_8hpp_html_a7cc5a6d57623c456857b1ba01ce919ee"><div class="ttname"><a href="../../d5/d4f/AH_2Settings_2Settings_8hpp.html#a7cc5a6d57623c456857b1ba01ce919ee">DEBUG_OUT</a></div><div class="ttdeci">#define DEBUG_OUT</div><div class="ttdoc">The debug output.</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4f/AH_2Settings_2Settings_8hpp_source.html#l00027">AH/Settings/Settings.hpp:27</a></div></div>
<div class="ttc" id="aclassNoteButton_html"><div class="ttname"><a href="../../d1/d9f/classNoteButton.html">NoteButton</a></div><div class="ttdoc">A class of MIDIOutputElements that read the input of a momentary push button or switch,...</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d80/NoteButton_8hpp_source.html#l00019">NoteButton.hpp:19</a></div></div>
</div><!-- fragment --><p> If you enable debug output, you'll get a helpful error message as soon as you open the Serial Monitor: </p><div class="fragment"><div class="line">[bool cs::Control_Surface_::connectDefaultMIDI_Interface() @ line 53]:  Fatal Error: No default MIDI Interface (0xF123)</div>
</div><!-- fragment --><p> The error code at the end can be used to easily locate the source of the error in the library source code, and in this case the message also includes the name of the function and the line number where the error occurred.</p>
<blockquote class="doxtable">
<p>&zwj;<b>Note</b>: Since the built-in LED will be configured as an output when an error occurs, you should not use it as an input (e.g. to connect a switch), because this will cause a short circuit that might destroy the pin. </p>
</blockquote>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
